<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Virtual Assessment 360°</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <!-- Pannellum CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum/build/pannellum.css"/>

  <style>
    body { margin:0; padding:0; display:flex; flex-direction:column; height:100vh; font-family:Arial, sans-serif; }

    /* Header khas Pertamina */
    header {
        background: linear-gradient(90deg, #0071bb, #00a859);
        color: white;
        text-align: center;
        padding: 15px 20px;
        font-size: 18px;
        font-weight: bold;
        letter-spacing: 0.5px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }

    main {
        flex:1;
        display:flex;
        flex-direction:row;
    }

    #map { width: 50%; height: 100%; }
    #panorama { width: 50%; height: 100%; border-left:2px solid #ccc; }

    /* RESPONSIVE MODE untuk HP */
    @media (max-width: 768px) {
        main {
            flex-direction: column;
        }
        #panorama, #map {
            width: 100%;
            height: 50vh;
            border-left: none;
            border-top: 2px solid #ccc;
        }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    Virtual Assessment 360° Untuk Proses Pengadaan Tanah di Lingkungan Land Operation Zona Rokan
  </header>

  <!-- Layout Peta + Panorama -->
  <main>
    <div id="panorama"></div>
    <div id="map"></div>
  </main>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/shpjs@latest/dist/shp.min.js"></script>

  <!-- Pannellum JS -->
  <script src="https://cdn.jsdelivr.net/npm/pannellum/build/pannellum.js"></script>

  <script>
    // Inisialisasi Peta, fokus ke Indonesia
    var map = L.map('map').setView([-2.5, 118], 5);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

    // Load shapefile batas kecamatan (opsional)
    fetch("batas_kecamatan.zip")
      .then(res => res.arrayBuffer())
      .then(buf => {
        shp(buf).then(function(geojson){
          L.geoJSON(geojson, {
            style: {color:"#FF0000", weight:2}
          }).addTo(map);
        });
      })
      .catch(err => console.log("Shapefile tidak ditemukan, skip"));

    // Inisialisasi Pannellum Viewer dengan beberapa scene
    var viewer = pannellum.viewer('panorama', {
        default: { firstScene: "sceneA" },
        scenes: {
            "sceneA": {
                title: "Lokasi A",
                type: "equirectangular",
                panorama: "foto360a.jpg",
                pitch: 0, yaw: 0, hfov: 110, autoLoad: true
            },
            "sceneB": {
                title: "Lokasi B",
                type: "equirectangular",
                panorama: "foto360b.jpg",
                pitch: 0, yaw: 0, hfov: 110, autoLoad: true
            },
            "sceneC": {
                title: "Lokasi C",
                type: "equirectangular",
                panorama: "foto360c.jpg",
                pitch: 0, yaw: 0, hfov: 110, autoLoad: true
            },
            "sceneD": {
                title: "Lokasi D",
                type: "equirectangular",
                panorama: "foto360d.jpg",
                pitch: 0, yaw: 0, hfov: 110, autoLoad: true
            }
        }
    });

    // Marker lokasi dengan koordinat asli
    var lokasiA = L.marker([0.777833, 101.400333]).addTo(map).bindPopup("Lokasi A");
    lokasiA.on('click', function() { viewer.loadScene('sceneA'); });

    var lokasiB = L.marker([1.255722, 101.130778]).addTo(map).bindPopup("Lokasi B");
    lokasiB.on('click', function() { viewer.loadScene('sceneB'); });

    var lokasiC = L.marker([1.254083, 101.132306]).addTo(map).bindPopup("Lokasi C");
    lokasiC.on('click', function() { viewer.loadScene('sceneC'); });

    var lokasiD = L.marker([0.844583, 101.385000]).addTo(map).bindPopup("Lokasi D");
    lokasiD.on('click', function() { viewer.loadScene('sceneD'); });
  </script>
</body>
</html>
